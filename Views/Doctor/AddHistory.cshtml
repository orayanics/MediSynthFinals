@model MediSynthFinals.ViewModel.DoctorMedHisViewModel
<link rel="stylesheet" href="~/css/form.css">
<body>
    <form method="post" asp-action="AddHistory" class="form" onsubmit="return validateForm(event)">
        <p class="form-title"><img alt="MediSynth" src="../imgs/logo.png" width="120" height="40"></p>
        <p class="patient-info">Patient No.</p>
        <div class="center">
            <p class="patient-ID">@Model.patientId.Substring(0,7)</p>
        </div>
        @*         <p class="patient-info">Patient Name</p>
        <div class="center">
        <p class="patient-ID">@Model.</p>
        </div> *@
        <p class="form-title">Medical History</p>

        <input hidden asp-for="patientId" value="@Model.patientId" />
        <input hidden asp-for="rtypeId" value="MedicalHistory" />

        <div class="input-container">
            <label asp-for="pastMedHistory" class="form-label"></label>
            <input asp-for="pastMedHistory" class="form-control">
            <span asp-validation-for="pastMedHistory" class="text-danger"></span>
        </div>

        <div class="input-container">
            <label asp-for="pastHospitalization" class="form-label"></label>
            <input asp-for="pastHospitalization" class="form-control">
            <span asp-validation-for="pastHospitalization" class="text-danger"></span>
        </div>

        <div class="input-container">
            <label asp-for="pastSurgicalOperation" class="form-label"></label>
            <input asp-for="pastSurgicalOperation" class="form-control">
            <span asp-validation-for="pastSurgicalOperation" class="text-danger"></span>
        </div>

        <div class="input-container">
            <label asp-for="medConcern" class="form-label"></label>
            <input asp-for="medConcern" class="form-control">
            <span asp-validation-for="medConcern" class="text-danger"></span>
        </div>

        <div class="input-container">
            <label asp-for="foodAllergy" class="form-label"></label>
            <input asp-for="foodAllergy" class="form-control">
            <span asp-validation-for="foodAllergy" class="text-danger"></span>
        </div>

        <div class="input-container">
            <label asp-for="drugAllergy" class="form-label"></label>
            <input asp-for="drugAllergy" class="form-control">
            <span asp-validation-for="drugAllergy" class="text-danger"></span>
        </div>

        <div class="input-container">
            <label asp-for="visitDate" class="form-label"></label>
            <input asp-for="visitDate" type="date" class="form-control">
            <span asp-validation-for="visitDate" class="text-danger"></span>
        </div>

        <div class="input-container">
            <label asp-for="attendingDoctor" class="form-label"></label>
            <input asp-for="attendingDoctor" class="form-control">
            <span asp-validation-for="attendingDoctor" class="text-danger"></span>
        </div>
        <br />
        <center>
            <button type="submit" class="submit">Submit</button>
        </center>
    </form>
    <script>

        function showValidationMessage(input) {
            hideValidationMessage(input);
            const validationMessage = "This field is required.";
            const div = document.createElement("div");
            div.className = "alert alert-danger";
            div.innerHTML = validationMessage;
            input.insertAdjacentElement("afterend", div);
            input.dataset.validationMessage = div;
        }


        function hideValidationMessage(input) {
            const existingDiv = input.dataset.validationMessage;
            if (existingDiv) {
                existingDiv.remove();
                input.dataset.validationMessage = null;
            }
        }


        function validateForm(event) {
            const form = document.querySelector(".form");
            const inputs = form.querySelectorAll(".form-control");

            let isValid = true;

            inputs.forEach(input => {
                if (!input.value.trim()) {
                    showValidationMessage(input);
                    isValid = false;
                } else {
                    hideValidationMessage(input);
                }
            });

            if (!isValid) {
                event.preventDefault();
            }

            return isValid;
        }
    </script>
</body>